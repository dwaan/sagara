@use 'variables';
@use 'typography';
@use 'selection';
@use 'after-before';
@use 'flex';

:root {
  --menu-shadow: 0 var(--pad-xl) var(--pad-xl) 0 rgba(0, 0, 0, 0.25);
}

header {
  @extend .flex-row-center;
  @extend .no-padding-margin;

  position: relative;
  z-index: 999;
  padding: var(--pad-s) var(--pad-xxl);
  justify-content: space-between;

  @media screen and (max-width: variables.$screen-wide-s) {
    padding: var(--pad-m) var(--pad-xl);
  }

  @media screen and (max-width: variables.$screen-normal-l) {
    padding: var(--pad-m);
  }

  >div {
    @extend .flex-row-center;

    z-index: 3;

    a {
      @extend .flex-row-center;
    }
  }

  li {
    @extend .flex-column-center;

    gap: var(--gap-xs);
    z-index: 3;

    @media screen and (max-width: variables.$screen-normal-l) {
      gap: var(--gap-xl);
    }
  }

  a {
    color: var(--dark-normal);
    align-self: center;

    &:hover {
      div.gradient {
        --rad1: 20%;
        --rad2: 40%;
        --rad3: 60%;
      }
    }
  }

  object {
    pointer-events: none;

    @media screen and (max-width: variables.$screen-wide-l) {
      width: 9.875rem !important;
      height: 3.5rem !important;
    }

    @media screen and (max-width: variables.$screen-small-l) {
      width: 8rem !important;
      height: 3.5rem !important;
    }
  }

  label {
    cursor: pointer;
  }

  input[type=radio] {
    display: none;
  }
}

//
// ! Desktop and Mobile Menu switcher
//

// Desktop menu toggle
#menu-close-trigger {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 1;

  display: block;
}

// Desktop menu toggle
#menu-close {
  &:checked+#menu-close-trigger {
    display: none;
  }
}

// Mobile and Tablet menu toggle
#menu-show-trigger {
  position: relative;
  z-index: 3;

  @media screen and (max-width: variables.$screen-normal-l) {
    display: flex;
  }

  i {
    @extend .flex-column-center;
    @extend .after-before;

    display: none;
    width: 2rem;
    height: 1.25rem;

    border-top: .125rem solid var(--dark-normal);

    transition: all var(--fast) var(--ease-back);

    @media screen and (max-width: variables.$screen-normal-l) {
      display: block;
    }

    @media screen and (max-width: variables.$screen-small-l) {
      width: 1.5rem;
    }

    &::before,
    &::after {
      height: .125rem;
      top: calc(50% - .125rem);
      background: var(--dark-normal);

      transition: all var(--fast) var(--ease-back);
    }

    &::after {
      top: calc(100% - .125rem);
      right: .25rem;
    }
  }

  &:hover {
    i {
      border-color: var(--neon-blue);

      &::before,
      &::after {
        background: var(--neon-blue);
      }
    }
  }

  span {
    @extend .flex-row-center;

    gap: var(--gap-s);
    display: none;

    @media screen and (max-width: variables.$screen-normal-l) {
      display: flex;
    }
  }

  &+menu {

    @media screen and (max-width: variables.$screen-normal-l) {
      opacity: 0;
      transition: opacity var(--fast) var(--ease-back);
    }
  }
}

// Mobile and Tablet menu toggle
#menu-show {
  &+label {
    @media screen and (max-width: variables.$screen-normal-l) {
      +menu {
        transform: translate(0, 2rem);
        transition: transform var(--fast) var(--ease-back), opacity var(--fast) var(--ease-back);
      }

      +menu>li {
        opacity: 0;
        transform: translate(2rem, 0);
        transition: transform var(--fast) var(--ease-back), opacity var(--fast) var(--ease-back);

        // Add more if menu content is more than 8
        @for $i from 1 through 8 {
          &:nth-child(#{$i}) {
            transition-delay: #{$i*32}ms;
          }
        }
      }
    }
  }

  &:checked+label {

    // Make hamburger icon into x icon
    i {
      border-color: transparent;

      &::before,
      &::after {
        top: calc(50% - .125rem);
        transform: rotate(40deg);
        right: 0;
      }

      &::after {
        transform: rotate(-40deg);
      }
    }

    +menu {
      @media screen and (max-width: variables.$screen-normal-l) {

        &,
        >li {
          opacity: 1;
          transform: translate(0, 0);
        }
      }
    }
  }
}

//
//! Popup menu
//

nav.menu {
  z-index: 2;

  >a {
    @extend .a--default;

    @media screen and (max-width: variables.$screen-normal-l) {
      display: flex;
    }
  }

  >label {
    >span {
      pointer-events: none;
    }

    @media screen and (max-width: variables.$screen-normal-l) {
      pointer-events: all;
    }
  }

  >menu {
    z-index: 2;

    @media screen and (max-width: variables.$screen-normal-l) {
      position: absolute;
      top: calc(var(--pad-m) * 2);
      right: 0;
      left: 0;

      padding: var(--pad-xxl) var(--pad-xl);

      flex-direction: column;
      align-items: flex-start;
      justify-content: flex-start;

      pointer-events: none;
      overflow: hidden;

      background: var(--white-transparent);
      box-shadow: var(--menu-shadow);
      backdrop-filter: blur(var(--pad-l));
    }

    @media screen and (max-width: variables.$screen-small-l) {
      top: calc(var(--pad-m) * 4);
    }

    >li {
      z-index: 2;

      pointer-events: all;

      >label {
        display: block;
        align-self: stretch;
      }

      >a,
      >label a {
        @extend .flex-row-center;
        @extend .before;

        z-index: 2;

        flex: auto;
        gap: var(--gap-xs);

        @media screen and (max-width: variables.$screen-normal-l) {
          justify-content: flex-start;
        }

        &::before {
          background: var(--neon-green);
          border: none;
          opacity: 0;
        }

        .arrow {
          width: 1rem;

          @media screen and (max-width: variables.$screen-wide-m) {
            display: none;
          }

          @media screen and (max-width: variables.$screen-normal-l) {
            display: flex;
            width: 100%;
          }

          &::before {
            right: calc(var(--bttn-m) / 4);
          }

          &::after {
            right: 0;
          }
        }
      }

      >label a {
        pointer-events: none;
      }

      //
      //! Menu radio switcher
      //

      &:hover,
      &[aria-current="page"],
      input:checked {
        z-index: 1;

        >a,
        >label a,
        +label a {
          color: var(--dark-static);

          &::before {
            top: calc(var(--bttn-m) / -2);
            left: calc(var(--bttn-m) / -1.25);
            right: calc(var(--bttn-m) / -1.25);
            bottom: calc(var(--bttn-m) / -2);
            opacity: 1;
          }
        }
      }

      &[aria-current="page"] {

        >a,
        >label a,
        +label a {
          color: var(--white-static);

          &::before {
            background: var(--neon-blue);
          }
        }
      }

      input:checked {

        >a,
        >label a,
        +label a {
          color: var(--dark-static);

          &::before {
            background: var(--neon-green);
          }
        }
      }

      // Show popup menu

      >nav.popup {
        opacity: 0;
        pointer-events: none;
        transform: translate(0, 2rem);
        transition: all var(--fast) var(--ease-back);

        @media screen and (max-width: variables.$screen-normal-l) {
          height: 0;
          margin-top: calc(var(--gap-xl) * -1);
          transform: translate(0, 0);
          pointer-events: none;
          overflow: hidden;
        }

        .button,
        menu>li {
          opacity: 0;
          transform: translate(0, 2rem);
          transition: transform var(--fast) var(--ease-back), opacity var(--fast) var(--ease-back);

          @media screen and (max-width: variables.$screen-normal-l) {
            transform: translate(2rem, 0);
          }
        }
      }

      // Show popup menu
      input:checked+label+nav.popup {
        margin-top: 0;
        opacity: 1;
        transform: translate(0, 0);

        @media screen and (max-width: variables.$screen-normal-l) {
          margin-top: 0;
          height: auto;
          pointer-events: all;
        }

        li,
        a {
          pointer-events: all;
        }

        .button,
        menu>li {
          opacity: 1;
          transform: translate(0, 0);
        }

        menu>li {

          // Add more if menu content is more than 8
          @for $i from 1 through 8 {
            &:nth-child(#{$i}) {
              transition-delay: #{$i*32}ms;
            }
          }
        }

        .button {
          transition-delay: 128ms;
        }
      }
    }
  }
}

nav.popup {
  @extend .flex-column-center;
  @extend .selection--minimal;

  position: absolute;
  z-index: 1;
  top: calc(var(--pad-m) * 2);
  left: 0;
  right: 0;
  padding: var(--pad-l) var(--pad-xxl) var(--pad-m);

  gap: var(--gap-xl);

  pointer-events: none;

  background: var(--white-transparent);
  box-shadow: var(--menu-shadow);
  backdrop-filter: blur(var(--pad-l));

  @media screen and (max-width: variables.$screen-wide-s) {
    top: calc(var(--pad-m) * 2.5);
  }

  @media screen and (max-width: variables.$screen-normal-l) {
    top: initial;
    position: static;
    padding: 0;
    gap: var(--pad-xs);

    background: unset;
    box-shadow: unset;
    backdrop-filter: unset;
  }

  // submenu
  >menu {
    gap: calc(var(--gap-l) / 2) var(--gap-xl);
    flex-wrap: wrap;

    @media screen and (max-width: variables.$screen-normal-l) {
      justify-content: flex-start;
      margin: 0 calc(var(--bttn-s) * -1);
    }

    a {
      @extend .a--submenu;

      text-align: center;

      @media screen and (max-width: variables.$screen-normal-l) {
        text-align: left;
      }

      strong {
        font-weight: 600;
      }
    }
  }

  li {
    align-self: stretch;

    min-width: 12rem;
    width: calc(25% - var(--gap-xl));
    max-width: 13.75rem;

    @media screen and (max-width: variables.$screen-normal-l) {
      flex-direction: row;

      width: 100%;
      min-width: initial;
      max-width: initial;

      padding-top: calc(var(--bttn-s) / 3);
      padding-bottom: calc(var(--bttn-s) / 3);
    }
  }

  .button {
    @media screen and (max-width: variables.$screen-normal-l) {
      width: 100%;
    }
  }

  svg {
    --size: 8rem;

    width: var(--size);
    height: var(--size);

    @media screen and (max-width: variables.$screen-normal-l) {
      --size: 3rem;
    }
  }
}